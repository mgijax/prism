#!/bin/csh -f

#
# Install
#
cd `dirname $0` && source ./Configuration

# Unpack ExtJS and create link
#
cd ./www/js 
rm -fr ${EXT} ext
gunzip -c ${EXT}.tar.gz | tar xvf -
ln -s ${EXT} ext
cd ../..

# Create prismConfig.py, containing copies of env vars
# needed by server.
#
cat > ./server/prismConfig.py <<EOF
# prismConfig.py
#
# Configuration parameters for imagePaneData CGI service.
#
# DO NOT EDIT THIS FILE.
# This file was generated by the installer. To change anything,
# edit the Configuration file, then rerun Install.
#
MGI_LIVE = "${MGI_LIVE}"
MGI_PYTHONLIB="${MGI_PYTHONLIB}"
MGI_PUBLICUSER="${MGI_PUBLICUSER}"
MGI_PUBLICPASSWORD = "${MGI_PUBLICPASSWORD}"
MGD_DBSERVER = "${MGD_DBSERVER}"
MGD_DBNAME = "${MGD_DBNAME}"
EOF

# Create prism-config.js, containing copies of env vars
# needed by client.
#
cat > ./www/js/prism-config.js <<EOF2
// prism-config.js
//
// Configuration parameters for Prism web client.
//
// DO NOT EDIT THIS FILE.
// This file was generated by the installer. To change anything,
// edit the Configuration file, then rerun Install.
//
Ext.namespace('PRISM');

PRISM.config = {
    IMAGEPANE_URL : "${IMAGEPANE_URL}",
    PIXELDB_URL : "${PIXELDB_URL}",
    HELP_URL : "${HELP_URL}",
    MGD_DBSERVER : "${MGD_DBSERVER}",
    MGD_DBNAME : "${MGD_DBNAME}"
};
EOF2
